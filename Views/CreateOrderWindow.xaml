<Window x:Class="InventoryPro.Views.CreateOrderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Create Order"
        Height="560"
        Width="760"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Text="Create Order"
                   FontSize="22"
                   FontWeight="Bold"
                   Margin="0,0,0,12"/>

        <!-- Wholesaler -->
        <StackPanel Grid.Row="1" Margin="0,0,0,12">
            <TextBlock Text="Shop / Wholesaler" FontWeight="SemiBold" Margin="0,0,0,6"/>

            <!-- Select existing OR type custom -->
            <ComboBox ItemsSource="{Binding Wholesalers}"
                      DisplayMemberPath="CompanyName"
                      IsEditable="True"
                      Text="{Binding WholesalerName, UpdateSourceTrigger=PropertyChanged}"
                      Height="28"/>
        </StackPanel>

        <!-- Order Lines -->
        <Grid Grid.Row="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Row input -->
            <Grid Grid.Row="0" Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="1.2*"/>
                    <ColumnDefinition Width="0.8*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <ComboBox Grid.Column="0"
                          ItemsSource="{Binding Items}"
                          DisplayMemberPath="Name"
                          SelectedItem="{Binding SelectedItem}"
                          Height="28"
                          Margin="0,0,8,0"/>

                <ComboBox Grid.Column="1"
                          ItemsSource="{Binding Warehouses}"
                          SelectedItem="{Binding SelectedWarehouse}"
                          Height="28"
                          Margin="0,0,8,0"/>

                <TextBox Grid.Column="2"
                         Text="{Binding Quantity, UpdateSourceTrigger=PropertyChanged}"
                         Height="28"
                         Margin="0,0,8,0"/>

                <Button Grid.Column="3"
                        Content="+ Add Product"
                        Padding="12,4"
                        Command="{Binding AddLineCommand}"/>
            </Grid>

            <!-- Lines table -->
            <DataGrid Grid.Row="2"
                      ItemsSource="{Binding OrderLines}"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      HeadersVisibility="Column"
                      GridLinesVisibility="All">

                <DataGrid.Columns>
                    <DataGridTextColumn Header="SKU" Binding="{Binding Item.SKU}" Width="120"/>
                    <DataGridTextColumn Header="Product" Binding="{Binding Item.Name}" Width="*"/>
                    <DataGridTextColumn Header="Warehouse" Binding="{Binding Warehouse}" Width="140"/>
                    <DataGridTextColumn Header="Qty" Binding="{Binding Quantity}" Width="80"/>

                    <DataGridTemplateColumn Header="Actions" Width="90">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Remove"
                                        Padding="8,2"
                                        Command="{Binding DataContext.RemoveLineCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                        CommandParameter="{Binding}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>

        <!-- Footer buttons -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Cancel"
                    Width="110"
                    Margin="0,0,10,0"
                    Command="{Binding CancelCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>

            <Button Content="Create Order"
                    Width="140"
                    Background="#10B981"
                    Foreground="White"
                    Command="{Binding CreateOrderCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"/>
        </StackPanel>
    </Grid>
</Window>
